# è’™ç‰¹å¡æ´›æ ‘æœç´¢

æ¦‚å¿µï¼š

+ çŠ¶æ€ï¼šæ¯ä¸ªè¢«æ‘‡åŠ¨çš„æ‘‡è‡‚å³ä¸ºä¸€ä¸ªçŠ¶æ€ï¼Œ$\set{s_1,\cdots,s_K}$
+ åŠ¨ä½œï¼šåŠ¨ä½œå¯¹åº”ç€æ‘‡åŠ¨ä¸€ä¸ªèµŒåšæœºçš„æ‘‡è‡‚ï¼Œ$\set{a_1,\cdots,a_K}$
+ çŠ¶æ€è½¬ç§»ï¼šé€‰æ‹©åŠ¨ä½œ$a_i$åï¼Œå°†çŠ¶æ€ç›¸åº”åœ°è½¬æ¢ä¸º$s_i$
+ å¥–åŠ±ï¼šè®¾ä»ç¬¬$i$ä¸ªèµŒåšæœºè·å¾—æ”¶ç›Šåˆ†æ•°çš„åˆ†å¸ƒä¸º$D_i$ï¼Œå…¶å‡å€¼ä¸º$\mu_i$ï¼Œå¦‚æœæ™ºèƒ½ä½“åœ¨ç¬¬$t$æ¬¡è¡ŒåŠ¨ä¸­é€‰æ‹©æ‘‡åŠ¨ç¬¬$l_i$ä¸ªèµŒåšæœºæ‘‡è‡‚ï¼Œé‚£ä¹ˆæ™ºèƒ½ä½“åœ¨ç¬¬$t$æ¬¡è¡ŒåŠ¨ä¸­æ‰€å¾—æ”¶ç›Šåˆ†$\hat{r_i}$æœä»åˆ†å¸ƒ$D_{l_i}$,ç§°ä¸ºç¬¬$t$æ¬¡è¡ŒåŠ¨çš„å¥–åŠ±
+ æ‚”å€¼å‡½æ•°ï¼š$\rho_T=T\mu^*-\sum\limits_{t=i}^T\hat{r_t}$ï¼Œå…¶ä¸­$\mu^*=\max\limits_{i=1,\cdots,k}\mu_i$ï¼Œä¸ºæœ€å¤§å€¼å’Œå®é™…å€¼ä¹‹å·®

è´ªå¿ƒç­–ç•¥ï¼šæ™ºèƒ½ä½“è®°å½•ä¸‹æ¯æ¬¡æ‘‡åŠ¨çš„èµŒåšæœºæ‘‡è‡‚å’Œè·å¾—çš„ç›¸åº”æ”¶ç›Šåˆ†æ•°ã€‚ç»™å®šç¬¬$i$ä¸ªèµŒåšæœºï¼Œè®°åœ¨è¿‡å»$t-1$æ¬¡æ‘‡åŠ¨èµŒåšæœºæ‘‡è‡‚çš„è¡ŒåŠ¨ä¸­ï¼Œæ‘‡åŠ¨ç¬¬iä¸ªèµŒåšæœºæ‘‡è‡‚çš„æ¬¡æ•°ä¸º$T_{(i,t-1)}$ã€‚äºæ˜¯ï¼Œå¯ä»¥è®¡ç®—å¾—åˆ°ç¬¬$i$ä¸ªèµŒåšæœºåœ¨è¿‡å»$T_{(i,t-1)}$æ¬¡è¢«æ‘‡åŠ¨è¿‡ç¨‹ä¸­çš„æ”¶ç›Šåˆ†æ•°å¹³å‡å€¼$\bar{x}_{i,T(i,t-1)}$ã€‚è¿™æ ·ï¼Œæ™ºèƒ½ä½“åœ¨ç¬¬$t$æ­¥ï¼Œåªè¦é€‰æ‹©$\bar{x}_{i,T(i,t-1)}$å€¼æœ€å¤§çš„èµŒåšæœºæ‘‡è‡‚è¿›è¡Œæ‘‡åŠ¨å³å¯ã€‚

é—®é¢˜ï¼šæ¢ç´¢ä¸åˆ©ç”¨çš„å¯¹ç«‹

## $\epsilon-$è´ªå¿ƒç®—æ³•

$$
l_t=\left\{\begin{array}{ll}\arg\max_i\bar{x}_{i,T(i,t-1)},&P=1-\epsilon,\\i\in\set{1,\cdots,K},&P=\epsilon\end{array}\right.
$$

é—®é¢˜ï¼šæ²¡æœ‰å°†æ¯ä¸ªåŠ¨ä½œè¢«æ¢ç´¢çš„æ¬¡æ•°çº³å…¥è€ƒè™‘

## è§£å†³ï¼šUCB1ç®—æ³•

+ ç­–ç•¥ï¼šä¸ºæ¯ä¸ªåŠ¨ä½œçš„å¥–åŠ±æœŸæœ›è®¡ç®—ä¸€ä¸ªä¼°è®¡èŒƒå›´ï¼Œä¼˜å…ˆé‡‡ç”¨ä¼°è®¡èŒƒå›´ä¸Šé™è¾ƒé«˜çš„åŠ¨ä½œ

æ¥ä¸‹æ¥çš„é—®é¢˜åœ¨äºç®—æ³•åº”è¯¥å¦‚ä½•è®¡ç®—å¥–åŠ±æœŸæœ›çš„ä¼°è®¡èŒƒå›´ï¼Œå°¤å…¶æ˜¯å¥–åŠ±æœŸæœ›çš„ç½®ä¿¡ä¸Šç•Œå‘¢ï¼Ÿ

å‡è®¾ç®—æ³•åœ¨è¿‡å»ç¬¬ $ğ‘¡$ æ¬¡å·²ç»å¯¹åŠ¨ä½œ $ğ‘_ğ‘–$ æ¢ç´¢äº† $ğ‘‡_{(ğ‘–,ğ‘¡âˆ’1)}$ æ¬¡ï¼Œåœ¨å½“å‰é—®é¢˜ä¸­å¯¹åº”æ‘‡åŠ¨äº†ç¬¬ $ğ‘–$ ä¸ªèµŒåšæœºçš„è‡‚è†€ $ğ‘‡_{(ğ‘–,ğ‘¡âˆ’1)}$ æ¬¡ï¼Œæ‰§è¡ŒåŠ¨ä½œ $ğ‘_ğ‘–$ æ‰€æ”¶åˆ°æ”¶ç›Šåˆ†æ•°çš„å‡å€¼ä¸º$\bar{ğ‘¥}_{ğ‘–,ğ‘‡_{(ğ‘–,ğ‘¡âˆ’1)} }$ã€‚è¿™$ğ‘‡_{(ğ‘–,ğ‘¡âˆ’1)}$æ¬¡åŠ¨ä½œå¯ä»¥çœ‹ä½œ$ğ‘‡_{(ğ‘–,ğ‘¡âˆ’1)}$ä¸ªå–å€¼èŒƒå›´åœ¨[0,1]çš„ç‹¬ç«‹åŒåˆ†å¸ƒéšæœºå˜é‡çš„æ ·æœ¬ï¼Œæ ¹æ®éœå¤«ä¸ä¸ç­‰å¼ï¼ˆHoeffdingâ€™s inequalityï¼‰ï¼Œæœ‰å¦‚ä¸‹å…¬å¼å­˜åœ¨ï¼š

!!! note "éœå¤«ä¸ä¸ç­‰å¼"
    $P(\mu_i-\bar{x}_{i,T(i,t-1)}>\delta)\leqslant e^{-2T_{(i,t-1)}\delta^2}$

æ•…$P(\mu_i>\bar{x}_{i,T(i,t-1)}+\delta)\leqslant e^{-2T_{(i,t-1)}\delta^2}$ï¼Œ$\delta\to0$æ—¶å¾—åˆ°æœŸæœ›ä¸Šç•Œã€‚

ä»¤$e^{-2T_{(i,t-1)}\delta^2}=t^{-4}\Rightarrow\mu_i$ä¸Šç•Œ$=\bar{x}_{i,T(i,t-1)}+\sqrt{\dfrac{2\ln t}{T_{i,(t-1)}}}$

æ•…UCB1ç­–ç•¥ï¼š

$$
l_t=\mathop{\arg\!\max}_i\bar{x}_{i,T(i,t-1)}+C\sqrt{\dfrac{2\ln t}{T_{i,(t-1)}}}
$$

å…¶ä¸­$C$ä¸ºå–ä¸åŒå¹‚å‡½æ•°ä½œæ”¶æ•›äº§ç”Ÿã€‚

!!! note ""

    UCB1ç®—æ³•åœ¨ç»è¿‡ $ğ‘‡$ æ¬¡æµ‹è¯•åï¼Œæ‚”å€¼å‡½æ•°çš„æœŸæœ›ä¸Šç•Œä¸º 
    
    $$O\left(\dfrac{K\ln T}{\Delta}\right),\Delta=\min_{i=1,\cdots,K,\mu_i<\mu}\mu^*-\mu_i$$

## è’™ç‰¹å¡æ´›æ ‘æœç´¢

!!! note ""
    ç®—æ³•äº‹å…ˆä¸çŸ¥é“æ¯ä¸ªç»“ç‚¹å°†ä¼šå¾—åˆ°æ€æ ·çš„ä»£ä»·ï¼ˆæˆ–ç»ˆå±€åˆ†æ•°ï¼‰åˆ†å¸ƒï¼Œåªèƒ½é€šè¿‡é‡‡æ ·å¼æ¢ç´¢æ¥å¾—åˆ°è®¡ç®—å¥–åŠ±çš„æ ·æœ¬ã€‚ç”±äºè¿™ä¸ªç®—æ³•åˆ©ç”¨è’™ç‰¹å¡æ´›æ³•é€šè¿‡é‡‡æ ·æ¥ä¼°è®¡æ¯ä¸ªç»“ç‚¹çš„ä»·å€¼ï¼Œå› æ­¤å®ƒè¢«ç§°ä¸ºè’™ç‰¹å¡æ´›æ ‘æœç´¢ï¼ˆMonte-Carlo Tree Searchï¼‰ç®—æ³•ã€‚

è’™ç‰¹å¡æ´›æ ‘æœç´¢ï¼ˆåŸºäºMinimaxæœç´¢ï¼‰ï¼š

1. é€‰æ‹©ï¼šç®—æ³•ä»æœç´¢æ ‘çš„æ ¹ç»“ç‚¹å¼€å§‹ï¼Œå‘ä¸‹é€’å½’é€‰æ‹©å­ç»“ç‚¹ï¼ˆç»“åˆå…·ä½“æœç´¢æ ‘ç­–ç•¥ç¡®å®šUCB1ï¼‰ï¼Œç›´è‡³åˆ°è¾¾å¶å­ç»“ç‚¹æˆ–è€…åˆ°è¾¾å°šæœªè¢«å®Œå…¨æ‰©å±•çš„ç»“ç‚¹$L$
2. æ‰©å±•ï¼šå¦‚æœç»“ç‚¹Lä¸æ˜¯ä¸€ä¸ªç»ˆæ­¢ç»“ç‚¹(æˆ–å¯¹æŠ—æœç´¢çš„ç»ˆå±€ç»“ç‚¹),åˆ™éšæœºæ‰©å±•å®ƒçš„ä¸€ä¸ªæœªè¢«æ‰©å±•è¿‡çš„åç»§ç»“ç‚¹M
3. æ¨¡æ‹Ÿï¼šä»ç»“ç‚¹Må‡ºå‘ï¼Œæ¨¡æ‹Ÿæ‰©å±•æœç´¢æ ‘ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªç»ˆæ­¢ç»“ç‚¹ï¼ˆéšæœºæ‰©å±•ï¼‰
4. åå‘ä¼ æ’­ï¼šç”¨æ¨¡æ‹Ÿæ‰€å¾—ç»“æœï¼ˆç»ˆæ­¢ç»“ç‚¹çš„ä»£ä»·æˆ–æ¸¸æˆç»ˆå±€åˆ†æ•°ï¼‰å›æº¯æ›´æ–°æ¨¡æ‹Ÿè·¯å¾„ä¸­Mä»¥ä¸Š(å«M)ç»“ç‚¹çš„å¥–åŠ±å‡å€¼å’Œè¢«è®¿é—®æ¬¡æ•°ï¼ˆä¸åŒå±‚æ¬¡æ›´æ–°ç­–ç•¥ä¸åŒï¼‰

![alt text](images/image-7.png)

![alt text](images/image-11.png)
![alt text](images/image-12.png)
![alt text](images/image-8.png)